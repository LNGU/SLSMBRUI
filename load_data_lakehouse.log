2026-02-24 13:04:43,182 INFO ============================================================
2026-02-24 13:04:43,182 INFO SLS MBR DATA LOAD TO LAKEHOUSE
2026-02-24 13:04:43,182 INFO ============================================================
2026-02-24 13:04:45,303 INFO Workspace: scm-dev (d3c735d2-8f5c-4d1a-b825-0cc5353a8de2)
2026-02-24 13:04:45,650 INFO Lakehouse: lakehouse (aa363084-8758-4301-8697-06bff14834cd)
2026-02-24 13:04:45,650 INFO 
2026-02-24 13:04:45,650 INFO STEP 0: Export data.js to CSV files
2026-02-24 13:04:45,650 INFO ----------------------------------------
2026-02-24 13:04:45,650 INFO === Exporting data.js to CSV files ===
2026-02-24 13:04:45,655 WARNING Failed to parse spendData: Expecting ',' delimiter: line 7 column 134 (char 818)
2026-02-24 13:04:45,655 INFO   Manually extracted 19 objects from spendData
2026-02-24 13:04:45,658 INFO   dim_Publisher.csv: 20 rows
2026-02-24 13:04:45,658 INFO   dim_Date.csv: 365 rows
2026-02-24 13:04:45,658 INFO   fact_Spend.csv: 19 rows
2026-02-24 13:04:45,667 INFO   fact_Risk.csv: 20 rows
2026-02-24 13:04:45,668 INFO   dim_ManagedTitle.csv: 43 rows
2026-02-24 13:04:45,669 INFO   fact_ExternalKPI.csv: 2 rows
2026-02-24 13:04:45,669 INFO 
2026-02-24 13:04:45,669 INFO STEP 1: Upload CSVs to OneLake
2026-02-24 13:04:45,669 INFO ----------------------------------------
2026-02-24 13:04:46,863 INFO === Uploading CSVs to OneLake ===
2026-02-24 13:04:46,863 INFO No environment configuration found.
2026-02-24 13:04:46,869 INFO ManagedIdentityCredential will use IMDS
2026-02-24 13:04:46,872 INFO Request URL: 'http://169.254.169.254/metadata/identity/oauth2/token?api-version=REDACTED&resource=REDACTED'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.2 Python/3.12.10 (Windows-11-10.0.26200-SP0)'
No body was attached to the request
2026-02-24 13:04:49,615 INFO DefaultAzureCredential acquired a token from AzureCliCredential
2026-02-24 13:04:49,615 INFO Request URL: 'https://msit-onelake.dfs.fabric.microsoft.com/d3c735d2-8f5c-4d1a-b825-0cc5353a8de2/aa363084-8758-4301-8697-06bff14834cd/Files/sls_mbr_data?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '732c049e-11c4-11f1-bb9a-381868ec7010'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-24 13:04:50,323 INFO Response status: 201
Response headers:
    'Content-Length': '0'
    'Date': 'Tue, 24 Feb 2026 21:04:50 GMT'
    'Server': 'Windows-Azure-HDFS/1.0, Microsoft-HTTPAPI/2.0'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'ETag': '"0x8DE73E8596B5640"'
    'Last-Modified': 'Tue, 24 Feb 2026 21:04:50 GMT'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '8e55374a-001f-0067-62d1-a5bc2e000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '732c049e-11c4-11f1-bb9a-381868ec7010'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
2026-02-24 13:04:50,325 INFO Created directory: aa363084-8758-4301-8697-06bff14834cd/Files/sls_mbr_data
2026-02-24 13:04:50,325 INFO   Uploading dim_Publisher.csv (1,944 bytes)...
2026-02-24 13:04:50,343 INFO Request URL: 'https://msit-onelake.dfs.fabric.microsoft.com/d3c735d2-8f5c-4d1a-b825-0cc5353a8de2/aa363084-8758-4301-8697-06bff14834cd/Files/sls_mbr_data/dim_Publisher.csv?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '753d9d82-11c4-11f1-a1b6-381868ec7010'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-24 13:04:50,440 INFO Response status: 201
Response headers:
    'Content-Length': '0'
    'Date': 'Tue, 24 Feb 2026 21:04:50 GMT'
    'Server': 'Windows-Azure-HDFS/1.0, Microsoft-HTTPAPI/2.0'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'ETag': '"0x8DE73E8597E8624"'
    'Last-Modified': 'Tue, 24 Feb 2026 21:04:50 GMT'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '8e55374c-001f-0067-64d1-a5bc2e000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '753d9d82-11c4-11f1-a1b6-381868ec7010'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
2026-02-24 13:04:50,443 INFO Request URL: 'https://msit-onelake.dfs.fabric.microsoft.com/d3c735d2-8f5c-4d1a-b825-0cc5353a8de2/aa363084-8758-4301-8697-06bff14834cd/Files/sls_mbr_data/dim_Publisher.csv?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '1944'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '754cdefc-11c4-11f1-873e-381868ec7010'
    'Authorization': 'REDACTED'
A body is sent with the request
2026-02-24 13:04:50,540 INFO Response status: 202
Response headers:
    'Content-Length': '0'
    'Date': 'Tue, 24 Feb 2026 21:04:50 GMT'
    'Server': 'Windows-Azure-HDFS/1.0, Microsoft-HTTPAPI/2.0'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '8e55374d-001f-0067-65d1-a5bc2e000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '754cdefc-11c4-11f1-873e-381868ec7010'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
2026-02-24 13:04:50,540 INFO Request URL: 'https://msit-onelake.dfs.fabric.microsoft.com/d3c735d2-8f5c-4d1a-b825-0cc5353a8de2/aa363084-8758-4301-8697-06bff14834cd/Files/sls_mbr_data/dim_Publisher.csv?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE73E8597E8624"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '755bc008-11c4-11f1-a42a-381868ec7010'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-24 13:04:50,629 INFO Response status: 200
Response headers:
    'Content-Length': '0'
    'Date': 'Tue, 24 Feb 2026 21:04:50 GMT'
    'Server': 'Windows-Azure-HDFS/1.0, Microsoft-HTTPAPI/2.0'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'ETag': '"0x8DE73E8599B5744"'
    'Last-Modified': 'Tue, 24 Feb 2026 21:04:50 GMT'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '8e55374e-001f-0067-66d1-a5bc2e000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '755bc008-11c4-11f1-a42a-381868ec7010'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
2026-02-24 13:04:50,631 INFO   [OK] dim_Publisher.csv
2026-02-24 13:04:50,631 INFO   Uploading dim_Date.csv (12,239 bytes)...
2026-02-24 13:04:50,647 INFO Request URL: 'https://msit-onelake.dfs.fabric.microsoft.com/d3c735d2-8f5c-4d1a-b825-0cc5353a8de2/aa363084-8758-4301-8697-06bff14834cd/Files/sls_mbr_data/dim_Date.csv?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '756c14bb-11c4-11f1-a5c2-381868ec7010'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-24 13:04:50,721 INFO Response status: 201
Response headers:
    'Content-Length': '0'
    'Date': 'Tue, 24 Feb 2026 21:04:50 GMT'
    'Server': 'Windows-Azure-HDFS/1.0, Microsoft-HTTPAPI/2.0'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'ETag': '"0x8DE73E859A93948"'
    'Last-Modified': 'Tue, 24 Feb 2026 21:04:50 GMT'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '8e553752-001f-0067-6ad1-a5bc2e000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '756c14bb-11c4-11f1-a5c2-381868ec7010'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
2026-02-24 13:04:50,721 INFO Request URL: 'https://msit-onelake.dfs.fabric.microsoft.com/d3c735d2-8f5c-4d1a-b825-0cc5353a8de2/aa363084-8758-4301-8697-06bff14834cd/Files/sls_mbr_data/dim_Date.csv?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '12239'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '75774e99-11c4-11f1-8295-381868ec7010'
    'Authorization': 'REDACTED'
A body is sent with the request
2026-02-24 13:04:50,793 INFO Response status: 202
Response headers:
    'Content-Length': '0'
    'Date': 'Tue, 24 Feb 2026 21:04:50 GMT'
    'Server': 'Windows-Azure-HDFS/1.0, Microsoft-HTTPAPI/2.0'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '8e553753-001f-0067-6bd1-a5bc2e000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '75774e99-11c4-11f1-8295-381868ec7010'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
2026-02-24 13:04:50,793 INFO Request URL: 'https://msit-onelake.dfs.fabric.microsoft.com/d3c735d2-8f5c-4d1a-b825-0cc5353a8de2/aa363084-8758-4301-8697-06bff14834cd/Files/sls_mbr_data/dim_Date.csv?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE73E859A93948"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '758258a9-11c4-11f1-9aa0-381868ec7010'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-24 13:04:50,885 INFO Response status: 200
Response headers:
    'Content-Length': '0'
    'Date': 'Tue, 24 Feb 2026 21:04:50 GMT'
    'Server': 'Windows-Azure-HDFS/1.0, Microsoft-HTTPAPI/2.0'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'ETag': '"0x8DE73E859C29740"'
    'Last-Modified': 'Tue, 24 Feb 2026 21:04:50 GMT'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '8e553755-001f-0067-6dd1-a5bc2e000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '758258a9-11c4-11f1-9aa0-381868ec7010'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
2026-02-24 13:04:50,886 INFO   [OK] dim_Date.csv
2026-02-24 13:04:50,886 INFO   Uploading fact_Spend.csv (1,040 bytes)...
2026-02-24 13:04:50,899 INFO Request URL: 'https://msit-onelake.dfs.fabric.microsoft.com/d3c735d2-8f5c-4d1a-b825-0cc5353a8de2/aa363084-8758-4301-8697-06bff14834cd/Files/sls_mbr_data/fact_Spend.csv?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '75927397-11c4-11f1-8ef9-381868ec7010'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-24 13:04:50,974 INFO Response status: 201
Response headers:
    'Content-Length': '0'
    'Date': 'Tue, 24 Feb 2026 21:04:50 GMT'
    'Server': 'Windows-Azure-HDFS/1.0, Microsoft-HTTPAPI/2.0'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'ETag': '"0x8DE73E859CFCF88"'
    'Last-Modified': 'Tue, 24 Feb 2026 21:04:50 GMT'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '8e553757-001f-0067-6fd1-a5bc2e000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '75927397-11c4-11f1-8ef9-381868ec7010'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
2026-02-24 13:04:50,974 INFO Request URL: 'https://msit-onelake.dfs.fabric.microsoft.com/d3c735d2-8f5c-4d1a-b825-0cc5353a8de2/aa363084-8758-4301-8697-06bff14834cd/Files/sls_mbr_data/fact_Spend.csv?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '1040'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '759de997-11c4-11f1-b585-381868ec7010'
    'Authorization': 'REDACTED'
A body is sent with the request
2026-02-24 13:04:51,044 INFO Response status: 202
Response headers:
    'Content-Length': '0'
    'Date': 'Tue, 24 Feb 2026 21:04:50 GMT'
    'Server': 'Windows-Azure-HDFS/1.0, Microsoft-HTTPAPI/2.0'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '8e553758-001f-0067-70d1-a5bc2e000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '759de997-11c4-11f1-b585-381868ec7010'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
2026-02-24 13:04:51,044 INFO Request URL: 'https://msit-onelake.dfs.fabric.microsoft.com/d3c735d2-8f5c-4d1a-b825-0cc5353a8de2/aa363084-8758-4301-8697-06bff14834cd/Files/sls_mbr_data/fact_Spend.csv?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE73E859CFCF88"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '75a8b4aa-11c4-11f1-9801-381868ec7010'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-24 13:04:51,144 INFO Response status: 200
Response headers:
    'Content-Length': '0'
    'Date': 'Tue, 24 Feb 2026 21:04:50 GMT'
    'Server': 'Windows-Azure-HDFS/1.0, Microsoft-HTTPAPI/2.0'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'ETag': '"0x8DE73E859E9D2B8"'
    'Last-Modified': 'Tue, 24 Feb 2026 21:04:51 GMT'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '8e55375a-001f-0067-72d1-a5bc2e000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '75a8b4aa-11c4-11f1-9801-381868ec7010'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
2026-02-24 13:04:51,144 INFO   [OK] fact_Spend.csv
2026-02-24 13:04:51,144 INFO   Uploading fact_Risk.csv (3,078 bytes)...
2026-02-24 13:04:51,157 INFO Request URL: 'https://msit-onelake.dfs.fabric.microsoft.com/d3c735d2-8f5c-4d1a-b825-0cc5353a8de2/aa363084-8758-4301-8697-06bff14834cd/Files/sls_mbr_data/fact_Risk.csv?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '75b9db74-11c4-11f1-b3eb-381868ec7010'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-24 13:04:51,310 INFO Response status: 201
Response headers:
    'Content-Length': '0'
    'Date': 'Tue, 24 Feb 2026 21:04:50 GMT'
    'Server': 'Windows-Azure-HDFS/1.0, Microsoft-HTTPAPI/2.0'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'ETag': '"0x8DE73E85A03DD5C"'
    'Last-Modified': 'Tue, 24 Feb 2026 21:04:51 GMT'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '70401f69-a01f-0041-1fd1-a5f436000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '75b9db74-11c4-11f1-b3eb-381868ec7010'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
2026-02-24 13:04:51,310 INFO Request URL: 'https://msit-onelake.dfs.fabric.microsoft.com/d3c735d2-8f5c-4d1a-b825-0cc5353a8de2/aa363084-8758-4301-8697-06bff14834cd/Files/sls_mbr_data/fact_Risk.csv?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '3078'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '75d147f5-11c4-11f1-8f41-381868ec7010'
    'Authorization': 'REDACTED'
A body is sent with the request
2026-02-24 13:04:51,408 INFO Response status: 202
Response headers:
    'Content-Length': '0'
    'Date': 'Tue, 24 Feb 2026 21:04:51 GMT'
    'Server': 'Windows-Azure-HDFS/1.0, Microsoft-HTTPAPI/2.0'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '8e553764-001f-0067-7bd1-a5bc2e000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '75d147f5-11c4-11f1-8f41-381868ec7010'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
2026-02-24 13:04:51,409 INFO Request URL: 'https://msit-onelake.dfs.fabric.microsoft.com/d3c735d2-8f5c-4d1a-b825-0cc5353a8de2/aa363084-8758-4301-8697-06bff14834cd/Files/sls_mbr_data/fact_Risk.csv?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE73E85A03DD5C"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '75e050d1-11c4-11f1-ac91-381868ec7010'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-24 13:04:51,498 INFO Response status: 200
Response headers:
    'Content-Length': '0'
    'Date': 'Tue, 24 Feb 2026 21:04:51 GMT'
    'Server': 'Windows-Azure-HDFS/1.0, Microsoft-HTTPAPI/2.0'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'ETag': '"0x8DE73E85A202C8C"'
    'Last-Modified': 'Tue, 24 Feb 2026 21:04:51 GMT'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '8e553765-001f-0067-7cd1-a5bc2e000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '75e050d1-11c4-11f1-ac91-381868ec7010'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
2026-02-24 13:04:51,500 INFO   [OK] fact_Risk.csv
2026-02-24 13:04:51,501 INFO   Uploading dim_ManagedTitle.csv (2,192 bytes)...
2026-02-24 13:04:51,521 INFO Request URL: 'https://msit-onelake.dfs.fabric.microsoft.com/d3c735d2-8f5c-4d1a-b825-0cc5353a8de2/aa363084-8758-4301-8697-06bff14834cd/Files/sls_mbr_data/dim_ManagedTitle.csv?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '75f16222-11c4-11f1-940b-381868ec7010'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-24 13:04:51,607 INFO Response status: 201
Response headers:
    'Content-Length': '0'
    'Date': 'Tue, 24 Feb 2026 21:04:51 GMT'
    'Server': 'Windows-Azure-HDFS/1.0, Microsoft-HTTPAPI/2.0'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'ETag': '"0x8DE73E85A2E89E4"'
    'Last-Modified': 'Tue, 24 Feb 2026 21:04:51 GMT'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '70401f78-a01f-0041-2dd1-a5f436000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '75f16222-11c4-11f1-940b-381868ec7010'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
2026-02-24 13:04:51,607 INFO Request URL: 'https://msit-onelake.dfs.fabric.microsoft.com/d3c735d2-8f5c-4d1a-b825-0cc5353a8de2/aa363084-8758-4301-8697-06bff14834cd/Files/sls_mbr_data/dim_ManagedTitle.csv?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '2192'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '75fe7d51-11c4-11f1-b8be-381868ec7010'
    'Authorization': 'REDACTED'
A body is sent with the request
2026-02-24 13:04:51,682 INFO Response status: 202
Response headers:
    'Content-Length': '0'
    'Date': 'Tue, 24 Feb 2026 21:04:51 GMT'
    'Server': 'Windows-Azure-HDFS/1.0, Microsoft-HTTPAPI/2.0'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '70401f7c-a01f-0041-31d1-a5f436000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '75fe7d51-11c4-11f1-b8be-381868ec7010'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
2026-02-24 13:04:51,682 INFO Request URL: 'https://msit-onelake.dfs.fabric.microsoft.com/d3c735d2-8f5c-4d1a-b825-0cc5353a8de2/aa363084-8758-4301-8697-06bff14834cd/Files/sls_mbr_data/dim_ManagedTitle.csv?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE73E85A2E89E4"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '7609f49e-11c4-11f1-8a2b-381868ec7010'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-24 13:04:51,781 INFO Response status: 200
Response headers:
    'Content-Length': '0'
    'Date': 'Tue, 24 Feb 2026 21:04:51 GMT'
    'Server': 'Windows-Azure-HDFS/1.0, Microsoft-HTTPAPI/2.0'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'ETag': '"0x8DE73E85A4B69E0"'
    'Last-Modified': 'Tue, 24 Feb 2026 21:04:51 GMT'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '70401f81-a01f-0041-36d1-a5f436000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '7609f49e-11c4-11f1-8a2b-381868ec7010'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
2026-02-24 13:04:51,784 INFO   [OK] dim_ManagedTitle.csv
2026-02-24 13:04:51,785 INFO   Uploading fact_ExternalKPI.csv (139 bytes)...
2026-02-24 13:04:51,798 INFO Request URL: 'https://msit-onelake.dfs.fabric.microsoft.com/d3c735d2-8f5c-4d1a-b825-0cc5353a8de2/aa363084-8758-4301-8697-06bff14834cd/Files/sls_mbr_data/fact_ExternalKPI.csv?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '761bc611-11c4-11f1-bf5e-381868ec7010'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-24 13:04:51,904 INFO Response status: 201
Response headers:
    'Content-Length': '0'
    'Date': 'Tue, 24 Feb 2026 21:04:51 GMT'
    'Server': 'Windows-Azure-HDFS/1.0, Microsoft-HTTPAPI/2.0'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'ETag': '"0x8DE73E85A5DE10C"'
    'Last-Modified': 'Tue, 24 Feb 2026 21:04:51 GMT'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '8e55376a-001f-0067-7fd1-a5bc2e000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '761bc611-11c4-11f1-bf5e-381868ec7010'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
2026-02-24 13:04:51,904 INFO Request URL: 'https://msit-onelake.dfs.fabric.microsoft.com/d3c735d2-8f5c-4d1a-b825-0cc5353a8de2/aa363084-8758-4301-8697-06bff14834cd/Files/sls_mbr_data/fact_ExternalKPI.csv?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '139'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '762bcf2b-11c4-11f1-979b-381868ec7010'
    'Authorization': 'REDACTED'
A body is sent with the request
2026-02-24 13:04:51,970 INFO Response status: 202
Response headers:
    'Content-Length': '0'
    'Date': 'Tue, 24 Feb 2026 21:04:51 GMT'
    'Server': 'Windows-Azure-HDFS/1.0, Microsoft-HTTPAPI/2.0'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '8e55376e-001f-0067-03d1-a5bc2e000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '762bcf2b-11c4-11f1-979b-381868ec7010'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
2026-02-24 13:04:51,970 INFO Request URL: 'https://msit-onelake.dfs.fabric.microsoft.com/d3c735d2-8f5c-4d1a-b825-0cc5353a8de2/aa363084-8758-4301-8697-06bff14834cd/Files/sls_mbr_data/fact_ExternalKPI.csv?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE73E85A5DE10C"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.23.0 Python/3.12.10 (Windows-11-10.0.26200-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '7635f827-11c4-11f1-858c-381868ec7010'
    'Authorization': 'REDACTED'
No body was attached to the request
2026-02-24 13:04:52,065 INFO Response status: 200
Response headers:
    'Content-Length': '0'
    'Date': 'Tue, 24 Feb 2026 21:04:51 GMT'
    'Server': 'Windows-Azure-HDFS/1.0, Microsoft-HTTPAPI/2.0'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'ETag': '"0x8DE73E85A765B00"'
    'Last-Modified': 'Tue, 24 Feb 2026 21:04:52 GMT'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '8e553770-001f-0067-05d1-a5bc2e000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '7635f827-11c4-11f1-858c-381868ec7010'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
2026-02-24 13:04:52,065 INFO   [OK] fact_ExternalKPI.csv
2026-02-24 13:04:52,065 INFO Uploaded 6/6 files to aa363084-8758-4301-8697-06bff14834cd/Files/sls_mbr_data
2026-02-24 13:04:52,067 INFO 
2026-02-24 13:04:52,067 INFO STEP 2: Load CSVs into Delta tables
2026-02-24 13:04:52,067 INFO ----------------------------------------
2026-02-24 13:04:52,067 INFO === Loading CSVs into Delta tables ===
2026-02-24 13:04:52,067 INFO   Loading dim_Publisher from dim_Publisher.csv...
2026-02-24 13:05:09,134 INFO   dim_Publisher: Running (None%) - poll 1
2026-02-24 13:05:14,409 INFO   dim_Publisher: Running (None%) - poll 2
2026-02-24 13:05:19,742 INFO   [OK] dim_Publisher (poll 3)
2026-02-24 13:05:19,742 INFO   Loading dim_Date from dim_Date.csv...
2026-02-24 13:05:36,427 INFO   [OK] dim_Date (poll 1)
2026-02-24 13:05:36,427 INFO   Loading fact_Spend from fact_Spend.csv...
2026-02-24 13:05:53,067 INFO   [OK] fact_Spend (poll 1)
2026-02-24 13:05:53,067 INFO   Loading fact_Risk from fact_Risk.csv...
2026-02-24 13:06:10,152 INFO   [OK] fact_Risk (poll 1)
2026-02-24 13:06:10,152 INFO   Loading dim_ManagedTitle from dim_ManagedTitle.csv...
2026-02-24 13:06:26,723 INFO   [OK] dim_ManagedTitle (poll 1)
2026-02-24 13:06:26,731 INFO   Loading fact_ExternalKPI from fact_ExternalKPI.csv...
2026-02-24 13:06:43,229 INFO   [OK] fact_ExternalKPI (poll 1)
2026-02-24 13:06:43,229 INFO Loaded 6/6 tables (0 failed)
2026-02-24 13:06:43,229 INFO 
2026-02-24 13:06:43,229 INFO ============================================================
2026-02-24 13:06:43,229 INFO DATA LOAD COMPLETE
2026-02-24 13:06:43,229 INFO ============================================================
